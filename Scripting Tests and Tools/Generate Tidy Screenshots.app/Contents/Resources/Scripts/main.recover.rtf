{\rtf1\ansi\ansicpg1252\cocoartf1265\cocoasubrtf190
{\fonttbl\f0\fnil\fcharset0 Verdana;}
{\colortbl;\red255\green255\blue255;\red76\green78\blue78;\red0\green0\blue0;\red0\green0\blue255;
\red64\green128\blue0;\red108\green5\blue211;\red0\green22\blue176;\red68\green21\blue176;}
\deftab480
\pard\pardeftab480\slleading20\pardirnatural

\f0\fs26 \cf2 --	Balthisar Tidy Screenshot Generation Utility\cf3 \
\pard\pardeftab480\slleading20\pardirnatural
\cf2 --\cf3 \
\cf2 --	This script uses Balthisar Tidy's AppleScript library and also\cf3 \
\cf2 --	Mac OS X UI Scripting capabilities in order to quickly and efficiently\cf3 \
\cf2 --	generate screenshots for the website, App Store, and help file.\cf3 \
\cf2 --\cf3 \
\cf2 --	Created by: Jim Derry\cf3 \
\cf2 --	Created on: 04/12/14 13:41:11\cf3 \
\cf2 --\cf3 \
\cf2 --	Copyright \'a9 2014 Jim Derry\cf3 \
\cf2 --	All Rights Reserved\cf3 \
\cf2 --\cf3 \
\
\
\cf2 ----------------------------------------------------------------\cf3 \
\cf2 --	run\cf3 \
\cf2 ----------------------------------------------------------------\cf3 \

\b on
\b0  
\b \cf4 run
\b0 \cf3 \
	\
	\cf2 ------------------------\cf3 \
	\cf2 -- configure these\cf3 \
	\cf2 ------------------------\cf3 \
	
\b set
\b0  \cf5 theBasePath\cf3  
\b to
\b0  (\cf6 POSIX path\cf3  
\b of
\b0  (
\b \cf7 path to
\b0 \cf3  
\i \cf8 desktop
\i0 \cf3 ))\
	
\b set
\b0  \cf5 imageoptions\cf3  
\b to
\b0  \{\cf5 omitshadow\cf3 :
\i \cf6 true
\i0 \cf3 , \cf5 imagetype\cf3 :"png"\}\
	\
	
\b set
\b0  \cf5 theMainWindowFilename\cf3  
\b to
\b0  "tidy-main-window.png"\
	
\b set
\b0  \cf5 thePrefsWindowFilename\cf3  
\b to
\b0  "tidy-prefs-0"\
	
\b set
\b0  \cf5 thePrefsFilenameSuffixNoSparkle\cf3  
\b to
\b0  "-ns"\
	\
	\
	\
	\cf2 ------------------------\cf3 \
	\cf2 -- Get Saving Path\cf3 \
	\cf2 ------------------------\cf3 \
	
\b try
\b0 \
		
\b set
\b0  \cf5 theBasePath\cf3  
\b to
\b0  (\cf6 POSIX path\cf3  
\b of
\b0  (
\b \cf7 choose folder
\b0 \cf3 ))\
	
\b end
\b0  
\b try
\b0 \
	\
	\
	\cf2 -----------------------------\cf3 \
	\cf2 -- Document Window\cf3 \
	\cf2 -----------------------------	\cf3 \
	
\b set
\b0  \cf5 the_window_id\cf3  
\b to
\b0  \cf5 set_document_window_size\cf3 (1280, 800)\
	\
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  "System Events"\
		
\b tell
\b0  
\i \cf4 process
\i0 \cf3  "Balthisar Tidy"\
			
\b tell
\b0  
\i \cf4 window
\i0 \cf3  
\i \cf6 named
\i0 \cf3  "Sample Dirty Document.html"\
				
\b tell
\b0  
\i \cf4 table
\i0 \cf3  1 
\b of
\b0  
\i \cf4 scroll area
\i0 \cf3  1 
\b of
\b0  
\i \cf4 group
\i0 \cf3  3 
\b of
\b0  
\i \cf4 splitter group
\i0 \cf3  1 
\b of
\b0  
\i \cf4 splitter group
\i0 \cf3  1\
					
\b set
\b0  \cf6 focused\cf3  
\b to
\b0  
\i \cf6 true
\i0 \cf3 \
					
\b tell
\b0  
\i \cf4 row
\i0 \cf3  1 
\b to
\b0  
\b set
\b0  \cf6 selected\cf3  
\b to
\b0  
\i \cf6 true
\i0 \cf3 \
				
\b end
\b0  
\b tell
\b0 \
			
\b end
\b0  
\b tell
\b0 \
		
\b end
\b0  
\b tell
\b0 \
	
\b end
\b0  
\b tell
\b0 \
	\
	\cf5 take_screenshot_window\cf3 (\cf5 the_window_id\cf3 , (\cf5 theBasePath\cf3  & \cf5 theMainWindowFilename\cf3 ), \cf5 imageoptions\cf3 )\
	\
	\
	\cf2 -----------------------------\cf3 \
	\cf2 -- Preferences\cf3 \
	\cf2 -----------------------------\cf3 \
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  "Balthisar Tidy"\
		\
		
\b set
\b0  \cf6 preferencesWindowIsVisible\cf3  
\b to
\b0  
\i \cf6 yes
\i0 \cf3 \
		\
		
\b set
\b0  \cf5 the_window_id\cf3  
\b to
\b0  \cf6 id\cf3  
\b of
\b0  (
\i \cf4 window
\i0 \cf3  
\i \cf6 named
\i0 \cf3  "Balthisar Tidy Preferences")\
		\
		
\b repeat
\b0  
\b with
\b0  \cf5 i\cf3  
\b from
\b0  1 
\b to
\b0  \cf6 countOfPrefsWindowPanels\cf3 \
			\
			
\b set
\b0  \cf6 indexOfVisiblePrefsWindowPanel\cf3  
\b to
\b0  \cf5 i\cf3 \
			\
			
\b set
\b0  \cf5 theFileName\cf3  
\b to
\b0  \cf5 theBasePath\cf3  & \cf5 thePrefsWindowFilename\cf3  & \cf5 i\cf3 \
			\
			
\b if
\b0  (\cf6 countOfPrefsWindowPanels\cf3  < 4) 
\b then
\b0 \
				
\b set
\b0  \cf5 theFileName\cf3  
\b to
\b0  \cf5 theFileName\cf3  & \cf5 thePrefsFilenameSuffixNoSparkle\cf3 \
			
\b end
\b0  
\b if
\b0 \
			\
			
\b set
\b0  \cf5 theFileName\cf3  
\b to
\b0  \cf5 theFileName\cf3  & "." & (\cf5 imagetype\cf3  
\b of
\b0  \cf5 imageoptions\cf3 )\
			\
			
\b tell
\b0  
\b me
\b0  
\b to
\b0  \cf5 take_screenshot_window\cf3 (\cf5 the_window_id\cf3 , \cf5 theFileName\cf3 , \cf5 imageoptions\cf3 )\
			\
		
\b end
\b0  
\b repeat
\b0 \
		\
		
\b set
\b0  \cf6 preferencesWindowIsVisible\cf3  
\b to
\b0  
\i \cf6 no
\i0 \cf3 \
		\
	
\b end
\b0  
\b tell
\b0 \
	\

\b end
\b0  
\b \cf4 run
\b0 \cf3 \
\
\
\cf2 ----------------------------------------------------------------\cf3 \
\cf2 --	set_document_window_size\cf3 \
\cf2 --		Sets an app's document window to the specified\cf3 \
\cf2 --		width and height\cf3 \
\cf2 -- @returns windowId as text\cf3 \
\cf2 ----------------------------------------------------------------\cf3 \

\b on
\b0  \cf5 set_document_window_size\cf3 (\cf5 winWidth\cf3 , \cf5 winHeight\cf3 )\
	\
	\cf2 ---------------------------------------------------------\cf3 \
	\cf2 -- Declare locals so we can see them in debugger.\cf3 \
	\cf2 ---------------------------------------------------------\cf3 \
	
\b local
\b0  \cf5 screenWidth\cf3 , \cf5 screenHeight\cf3 , \cf5 yAxis\cf3 , \cf5 xAxis\cf3 \
	
\b local
\b0  \cf5 scriptPath\cf3 , \cf5 theSampleFile\cf3 \
	
\b local
\b0  \cf5 theOpenDocument\cf3 \
	\
	\cf2 ---------------------------------------------------------\cf3 \
	\cf2 -- Windows and screen size math\cf3 \
	\cf2 ---------------------------------------------------------\cf3 \
	
\b set
\b0  \cf5 screenWidth\cf3  
\b to
\b0  
\i \cf4 item
\i0 \cf3  3 
\b of
\b0  \cf5 screen_bounds\cf3 ()\
	
\b set
\b0  \cf5 screenHeight\cf3  
\b to
\b0  
\i \cf4 item
\i0 \cf3  4 
\b of
\b0  \cf5 screen_bounds\cf3 ()\
	
\b set
\b0  \cf5 yAxis\cf3  
\b to
\b0  (\cf5 screenHeight\cf3  - \cf5 winHeight\cf3 ) / 2 
\b as
\b0  
\i \cf4 integer
\i0 \cf3 \
	
\b set
\b0  \cf5 xAxis\cf3  
\b to
\b0  (\cf5 screenWidth\cf3  - \cf5 winWidth\cf3 ) / 2 
\b as
\b0  
\i \cf4 integer
\i0 \cf3 \
	\
	\cf2 ---------------------------------------------------------\cf3 \
	\cf2 -- Find out where our testing document is\cf3 \
	\cf2 ---------------------------------------------------------\cf3 \
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  "Finder"\
		
\b set
\b0  \cf5 scriptPath\cf3  
\b to
\b0  (
\i \cf4 container
\i0 \cf3  
\b of
\b0  
\i \cf4 file
\i0 \cf3  (
\b \cf7 path to
\b0 \cf3  
\b me
\b0 )) 
\b as
\b0  
\i \cf4 string
\i0 \cf3 \
		
\b set
\b0  \cf5 theSampleFile\cf3  
\b to
\b0  (\cf5 scriptPath\cf3  & "Sample Dirty Document.html") 
\b as
\b0  
\i \cf4 string
\i0 \cf3 \
	
\b end
\b0  
\b tell
\b0 \
	\
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  "Balthisar Tidy"\
		
\b set
\b0  \cf5 theOpenDocument\cf3  
\b to
\b0  (
\b \cf4 open
\b0 \cf3  \cf5 theSampleFile\cf3 )\
		
\b set
\b0  
\b the
\b0  \cf6 bounds\cf3  
\b of
\b0  
\b the
\b0  
\b first
\b0  
\i \cf4 window
\i0 \cf3  
\b to
\b0  \{\cf5 xAxis\cf3 , \cf5 yAxis\cf3 , \cf5 winWidth\cf3  + \cf5 xAxis\cf3 , \cf5 winHeight\cf3  + \cf5 yAxis\cf3 \}\
		
\b return
\b0  \cf6 id\cf3  
\b of
\b0  
\i \cf4 window
\i0 \cf3  1\
	
\b end
\b0  
\b tell
\b0 \
	\

\b end
\b0  \cf5 set_document_window_size\cf3 \
\
\
\cf2 ----------------------------------------------------------------\cf3 \
\cf2 --	take_screenshot_window\cf3 \
\cf2 -- 		Saves an app's window to a Posix path. The\cf3 \
\cf2 --		options is a record:\cf3 \
\cf2 --			imagetype: string png, jpg, etc.\cf3 \
\cf2 --			omitshadow: boolean\cf3 \
\cf2 ----------------------------------------------------------------\cf3 \

\b on
\b0  \cf5 take_screenshot_window\cf3 (\cf5 the_window_id\cf3 , \cf5 a_file_path\cf3 , \cf5 options\cf3 )\
	\
	\cf2 ---------------------------------------------------------\cf3 \
	\cf2 -- Declare locals so we can see them in debugger.\cf3 \
	\cf2 ---------------------------------------------------------\cf3 \
	
\b local
\b0  \cf5 shell_command\cf3 \
	\
	\cf2 ---------------------------------------------------------\cf3 \
	\cf2 -- Build the string we will pass to bash\cf3 \
	\cf2 ---------------------------------------------------------\cf3 \
	
\b set
\b0  \cf5 shell_command\cf3  
\b to
\b0  "screencapture -l" & \cf5 the_window_id\cf3 \
	\
	
\b if
\b0  (\cf5 omitshadow\cf3  
\b of
\b0  (\cf5 options\cf3  & \{\cf5 omitshadow\cf3 :
\i \cf6 true
\i0 \cf3 \})) 
\b then
\b0 \
		
\b set
\b0  \cf5 shell_command\cf3  
\b to
\b0  \cf5 shell_command\cf3  & " -o"\
	
\b end
\b0  
\b if
\b0 \
	\
	
\b set
\b0  \cf5 shell_command\cf3  
\b to
\b0  \cf5 shell_command\cf3  & " -t" & \cf5 imagetype\cf3  
\b of
\b0  (\cf5 options\cf3  & \{\cf5 imagetype\cf3 :"png"\})\
	\
	
\b set
\b0  \cf5 shell_command\cf3  
\b to
\b0  \cf5 shell_command\cf3  & " " & (\cf6 quoted form\cf3  
\b of
\b0  \cf5 a_file_path\cf3 )\
	\
	\cf2 ---------------------------------------------------------\cf3 \
	\cf2 -- Pop it to the front and execute the command.\cf3 \
	\cf2 ---------------------------------------------------------\cf3 \
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  "System Events" 
\b to
\b0  
\b set
\b0  \cf6 frontmost\cf3  
\b of
\b0  
\i \cf4 process
\i0 \cf3  "Balthisar Tidy" 
\b to
\b0  
\i \cf6 true
\i0 \cf3 \
	
\b \cf4 delay
\b0 \cf3  1\
	
\b \cf7 do shell script
\b0 \cf3  \cf5 shell_command\cf3 \
	\

\b end
\b0  \cf5 take_screenshot_window\cf3 \
\
\
\cf2 ----------------------------------------------------------------\cf3 \
\cf2 --	screen_bounds\cf3 \
\cf2 --		Convenience to fetch the main screen dimensions.\cf3 \
\cf2 ----------------------------------------------------------------\cf3 \

\b on
\b0  \cf5 screen_bounds\cf3 ()\
	
\b tell
\b0  
\i \cf4 application
\i0 \cf3  "Finder"\
		
\b return
\b0  \cf6 bounds\cf3  
\b of
\b0  
\i \cf4 window
\i0 \cf3  
\b of
\b0  \cf6 desktop\cf3 \
	
\b end
\b0  
\b tell
\b0 \

\b end
\b0  \cf5 screen_bounds\cf3 \
\
}